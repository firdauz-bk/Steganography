<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta and Title -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cypher Steg</title>
    
    <!-- External CSS and JS Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Link to External CSS using url_for -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

</head>
<body class="min-h-screen flex items-center justify-center p-4 matrix-bg" x-data="{ activeTab: 'encode', resultVisible: false, resultText: '' }">
    <div class="bg-black bg-opacity-80 p-8 rounded-xl neon-border w-full max-w-3xl">
        <h1 class="text-4xl font-bold mb-8 text-center neon-text glitch">CypherSteg</h1>

    <div class="mb-6 flex justify-center space-x-4">
        <a href="{{ url_for('index') }}" class="px-6 py-2 rounded-full font-semibold transition duration-300 ease-in-out hover:neon-border
            {% if request.endpoint == 'index' %} bg-cyan-600 text-black {% else %} bg-gray-800 text-cyan-400 {% endif %}">
            Encode
        </a>
        <a href="{{ url_for('decode') }}" class="px-6 py-2 rounded-full font-semibold transition duration-300 ease-in-out hover:neon-border
            {% if request.endpoint == 'decode' %} bg-cyan-600 text-black {% else %} bg-gray-800 text-cyan-400 {% endif %}">
            Decode
        </a>
    </div>
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <div class="bg-red-500 text-white p-4 mb-4 rounded">
            {{ messages[0] }}
        </div>
    {% endif %}
{% endwith %}

    <div class="bg-gray-900 p-4 rounded-lg">
        <label for="coverObject" class="block mb-2 font-semibold text-cyan-400">Cover Object:</label>
        <select id="coverObject" name="coverObject" onchange="handleCoverObjectChange(this)" class="w-full border-2 border-cyan-600 rounded-lg p-2 bg-black text-cyan-400 focus:border-cyan-400 focus:ring focus:ring-cyan-400 transition">
            <option value="image">Image (PNG, GIF, BMP)</option>
            <option value="audio">Audio (MP3, WAV)</option>
            <option value="video">Video (MP4)</option>
        </select>
    </div>
        <form action="{{ url_for('encode_image_route') }}" method="post" enctype="multipart/form-data" class="space-y-6">
            <div class="bg-gray-900 p-4 rounded-lg">
                <label for="payload" class="block mb-2 font-semibold text-cyan-400">Payload (Text File):</label>
                <input type="file" id="payload" name="payload" accept=".txt" required class="w-full border-2 border-cyan-600 rounded-lg p-2 bg-black text-cyan-400 focus:border-cyan-400 focus:ring focus:ring-cyan-400 transition">
            </div>

            <div class="bg-gray-900 p-4 rounded-lg">
                <label for="cover" class="block mb-2 font-semibold text-cyan-400">Cover Object: Image (PNG, GIF, BMP)</label>
                <input type="file" id="cover" name="cover" accept=".png,.gif,.bmp" required class="w-full border-2 border-cyan-600 rounded-lg p-2 bg-black text-cyan-400 focus:border-cyan-400 focus:ring focus:ring-cyan-400 transition">
            </div>

            <button type="submit" class="w-full bg-cyan-600 text-black py-2 rounded-full font-semibold transition duration-300 ease-in-out hover:bg-cyan-500">Initiate Encoding Sequence</button>
        </form>
    </div>

    <script>
        // Store the URLs generated by Flask
        var urls = {
            image: "{{ url_for('image') }}",
            audio: "{{ url_for('audio') }}",
            video: "{{ url_for('video') }}"
        };

        function handleCoverObjectChange(selectElement) {
            const coverObject = selectElement.value;
            
            if (coverObject && coverObject in urls) {
                window.location.href = urls[coverObject];
            }
        }
    </script>
</body>
</html>